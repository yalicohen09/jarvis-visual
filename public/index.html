<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>JARVIS Interface</title>
  <style>
    body {
      margin: 0;
      background-color: black;
      color: #00ffff;
      font-family: 'Orbitron', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .face {
      margin-top: 50px;
    }
    .face img {
      width: 300px;
      transition: 0.3s;
    }
    .waveform {
      margin-top: 20px;
      height: 100px;
      width: 50%;
    }
    .dashboard {
      display: flex;
      justify-content: space-around;
      width: 80%;
      margin-top: 40px;
      color: #00ffff;
    }
    .section {
      text-align: center;
    }
    .graph {
      width: 200px;
      height: 100px;
      background: #001f1f;
      margin: 10px auto;
    }
  </style>
</head>
<body>
  <div class="face">
    <img id="jarvis-face" src="https://cdn.glitch.global/e2b1c048-c542-433a-a1b0-8c21b6c18e4c/closed.png?v=1745346349736" alt="Jarvis Face">
  </div>
  
  <canvas id="waveform" class="waveform"></canvas>

  <div class="dashboard">
    <div class="section">
      <h3>CPU Usage</h3>
      <canvas id="cpuGraph" class="graph"></canvas>
    </div>
    <div class="section">
      <h3>Controls</h3>
      <p>LIGHTS: ON</p>
      <p>THERMOSTAT</p>
      <p>SECURITY</p>
    </div>
  </div>

  <script>
    // WebSocket לשינוי הפנים
    const ws = new WebSocket('wss://jarvis-visual.onrender.com');
    ws.onmessage = (event) => {
      const face = document.getElementById('jarvis-face');
      if (event.data === 'start_talking') {
        face.src = 'https://cdn.glitch.global/e2b1c048-c542-433a-a1b0-8c21b6c18e4c/open.png?v=1745346330557';
      } else if (event.data === 'stop_talking') {
        face.src = 'https://cdn.glitch.global/e2b1c048-c542-433a-a1b0-8c21b6c18e4c/closed.png?v=1745346349736';
      }
    };

    // Waveform אנימציה
    const waveCanvas = document.getElementById('waveform');
    const waveCtx = waveCanvas.getContext('2d');
    waveCanvas.width = waveCanvas.offsetWidth;
    waveCanvas.height = waveCanvas.offsetHeight;

    function drawWaveform() {
      waveCtx.clearRect(0, 0, waveCanvas.width, waveCanvas.height);
      waveCtx.beginPath();
      for (let i = 0; i < waveCanvas.width; i += 5) {
        const y = waveCanvas.height / 2 + Math.sin(i * 0.05 + Date.now() * 0.005) * 20;
        waveCtx.lineTo(i, y);
      }
      waveCtx.strokeStyle = '#00ffff';
      waveCtx.stroke();
      requestAnimationFrame(drawWaveform);
    }
    drawWaveform();

    // גרף CPU דינמי
    const cpuCanvas = document.getElementById('cpuGraph');
    const cpuCtx = cpuCanvas.getContext('2d');
    cpuCanvas.width = cpuCanvas.offsetWidth;
    cpuCanvas.height = cpuCanvas.offsetHeight;
    let cpuData = [];

    function drawCpuGraph() {
      cpuCtx.clearRect(0, 0, cpuCanvas.width, cpuCanvas.height);
      cpuCtx.beginPath();
      cpuData.push(Math.random() * cpuCanvas.height);
      if (cpuData.length > cpuCanvas.width) cpuData.shift();
      cpuData.forEach((point, index) => {
        cpuCtx.lineTo(index, cpuCanvas.height - point);
      });
      cpuCtx.strokeStyle = '#00ffff';
      cpuCtx.stroke();
      requestAnimationFrame(drawCpuGraph);
    }
    drawCpuGraph();
  </script>
</body>
</html>
